<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Market Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont;
            background: #f5f7fa;
            margin: 0;
            padding: 20px;
            color: #222;
        }
        h1 {
            margin-bottom: 5px;
        }
        .container {
            max-width: 1200px;
            margin: auto;
        }
        .card {
            background: #fff;
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 14px rgba(0,0,0,.06);
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
            gap: 16px;
        }
        .metric {
            font-size: 28px;
            font-weight: bold;
        }
        .label {
            font-size: 13px;
            color: #666;
        }
        .trend-up { color: #d32f2f; }
        .trend-down { color: #2e7d32; }
        .trend-flat { color: #555; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }
        th {
            background: #fafafa;
            font-size: 13px;
            color: #555;
        }
        tr:hover {
            background: #f9fbff;
        }

        .summary {
            line-height: 1.6;
            font-size: 15px;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .hot { background:#ffe2e2; color:#c62828; }
        .cool { background:#e3f2fd; color:#1565c0; }
        .neutral { background:#eeeeee; color:#333; }

        footer {
            margin-top: 30px;
            font-size: 12px;
            color: #888;
            text-align: center;
        }
    </style>
</head>

<body>
<div class="container">

    <h1>üìä Market Dashboard</h1>
    <div class="label">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: {{ overview.date if overview }}</div>

    <!-- OVERVIEW -->
    <div class="card grid">
        <div>
            <div class="label">‡∏ï‡∏•‡∏≤‡∏î</div>
            <div class="metric">{{ overview.market if overview }}</div>
        </div>
        <div>
            <div class="label">‡πÑ‡∏ã‡∏™‡πå</div>
            <div class="metric">{{ overview.size if overview }}</div>
        </div>
        <div>
            <div class="label">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
            <div class="metric">{{ overview.avg_price if overview }} ‡∏ø</div>
        </div>
        <div>
            <div class="label">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</div>
            {% if overview.trend == "‚Üë" %}
                <div class="metric trend-up">‚Üë ‡∏Ç‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô</div>
            {% elif overview.trend == "‚Üì" %}
                <div class="metric trend-down">‚Üì ‡∏≠‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß</div>
            {% else %}
                <div class="metric trend-flat">‚Üí ‡∏ó‡∏£‡∏á‡∏ï‡∏±‡∏ß</div>
            {% endif %}
        </div>
    </div>

    <!-- EXECUTIVE SUMMARY -->
    <div class="card">
        <h3>üß† Executive Summary</h3>
        <div class="summary">
            {{ summary|safe }}
        </div>
    </div>

    <!-- 7 vs 7 -->
    {% if compare_7d %}
    <div class="card grid">
        <div>
            <div class="label">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
            <div class="metric">{{ compare_7d.avg_last_7 }} ‡∏ø</div>
        </div>
        <div>
            <div class="label">7 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</div>
            <div class="metric">{{ compare_7d.avg_prev_7 }} ‡∏ø</div>
        </div>
        <div>
            <div class="label">‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á</div>
            <div class="metric">
                {{ compare_7d.diff }} ‡∏ø
                ({{ compare_7d.pct }}%)
            </div>
        </div>
        <div>
            <div class="label">‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì</div>
            <div class="metric">
                {{ compare_7d.trend }}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- TABLE -->
    <div class="card">
        <h3>üìã ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
        <table>
            <thead>
            <tr>
                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                <th>‡∏ï‡∏•‡∏≤‡∏î</th>
                <th>‡πÑ‡∏ã‡∏™‡πå</th>
                <th>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</th>
            </tr>
            </thead>
            <tbody>
            {% for p in prices %}
                <tr>
                    <td>{{ p.date }}</td>
                    <td>{{ p.market }}</td>
                    <td>{{ p.size }}</td>
                    <td>{{ "%.2f"|format(p.price) }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <footer>
        ‚ö° Cached 5 ‡∏ô‡∏≤‡∏ó‡∏µ | Data Source: Google Sheet
    </footer>

</div>
</body>
</html>

